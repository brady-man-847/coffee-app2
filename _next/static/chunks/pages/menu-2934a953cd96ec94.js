(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[934],{3023:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/menu",function(){return t(6281)}])},5179:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(5893),o=t(4974),a=t(7294);function l(e){let{handleValueChange:n,...t}=e,[l,i]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=localStorage.getItem("phone");e&&(i(e),n(e))},[]);let s=e=>{let{value:t}=e.target,r=t.replace(/\D/g,"").replace(/(\d{3})(\d{4})(\d{4})/,"$1-$2-$3").slice(0,13);i(r),n(r)};return(0,r.jsx)(o.Z,{type:"text",id:"phone-number-input",value:l,onChange:s,...t,sx:{width:"100%"}})}},1084:function(e,n,t){"use strict";t.d(n,{g:function(){return a}});var r=t(5893),o=t(1458);function a(){return(0,r.jsx)(o.Z,{sx:{background:"linear-gradient(to right, #6fcbb6, #9c64f4)","> span":{backgroundColor:"primary"}}})}},6281:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return W}});var r=t(5893),o=t(1084),a=t(7294),l=t(4682);let i={isDrawerOpen:!1,menu:{},order:{}},s=(e,n)=>{switch(n.type){case"SET_DRAWER_OPEN":return{...e,isDrawerOpen:n.isDrawerOpen};case"SET_MENU":return{...e,menu:n.menu};case"SET_ORDER":return{...e,order:n.order};case"INIT_MENU":return{...i};default:throw Error("unknown action type")}},c=()=>(0,a.useReducer)(s,i),d=(0,l.kr)([i,()=>null]);var u=t(5676),p=t(8228),x=t(8433),m=t(6486),h=t.n(m);function f(){let e=async e=>{let{order:n,menuCode:t}=e,{data:r}=await x.Z.post("https://mcafe-api.onrender.com/order",{...n,menuCode:t,optionValueList:h().compact(h().values(n.optionValueList)),setDefault:!1});return r};return(0,p.D)(u.a.order.add(),e)}var g=t(8364),j=t(5861),v=t(7357),E=t(3321),Z=t(6242),w=t(629);function S(e){let{type:n,data:t}=e,[o,i]=(0,a.useState)(!1),s=(0,l.Sz)(d,e=>e[1]),{mutate:c,isLoading:u}=f(),p=e=>{0!==e.stock&&(s({type:"SET_DRAWER_OPEN",isDrawerOpen:!0}),s({type:"SET_MENU",menu:e}))},x=()=>(0,r.jsx)(j.Z,{children:"메뉴가 없습니다."}),m=e=>()=>{if(window.confirm("최근 주문 메뉴를 선택하시겠습니까?")){let{order:n,menuCode:t}=JSON.parse(localStorage.getItem(e));c({order:n,menuCode:t},{onSuccess:e=>window.alert(e),onError:e=>{window.alert(e.message)}})}},h=(0,a.useCallback)(()=>{let e=function(e){let n,t=[];for(n in localStorage)if(localStorage.hasOwnProperty(n)&&(n.match(e)||!e&&"string"==typeof n)){let e=JSON.parse(localStorage.getItem(n));t.push({key:n,val:e})}return t}("coffee_order_");if((null==e?void 0:e.length)===0)return x();let n=()=>{window.confirm("최근 주문 메뉴를 초기화 하시겠습니까?")&&(e.map(e=>{localStorage.removeItem(e.key)}),i(!o))};return(0,r.jsxs)(v.Z,{sx:{display:"flex",gap:1,overflow:"auto"},children:[(0,r.jsx)(E.Z,{onClick:n,variant:"contained",children:(0,r.jsx)(g.Z,{})}),e.map(e=>{var n;let{key:t,val:o}=e,a=t.split("_")[2].split("T")[0];return(0,r.jsx)(v.Z,{sx:{display:"flex",flexDirection:"row"},children:(0,r.jsxs)(Z.Z,{sx:{p:2,flex:3,minWidth:200},variant:"outlined",onClick:m(t),children:[(0,r.jsx)("div",{children:a}),(0,r.jsx)("div",{children:o.menuName}),(0,r.jsx)("div",{children:Object.entries(null===(n=o.order)||void 0===n?void 0:n.optionNameList).map(e=>{let[,n]=e;return(0,r.jsx)("li",{children:"".concat(n)})})}),(0,r.jsx)("div",{children:o.order.phone})]})})})]})},[o]);return(0,r.jsx)(v.Z,{sx:{display:"flex",flexDirection:"column",gap:"1px"},children:"RECENT"===n?h():(0,r.jsxs)(r.Fragment,{children:[(null==t?void 0:t.length)===0&&x(),null==t?void 0:t.map((e,n)=>(0,r.jsx)(w.Z,{elevation:3,onClick:()=>p(e),sx:[{p:1},n=>({backgroundColor:0===e.stock?n.palette.grey[100]:"",color:0===e.stock?n.palette.grey[300]:"","&:hover":{backgroundColor:0===e.stock?n.palette.grey[300]:n.palette.primary.contrastText,cursor:0===e.stock?"not-allowed":"pointer",color:0===e.stock?n.palette.grey[300]:n.palette.primary.main}})],children:(0,r.jsx)(j.Z,{children:0===e.stock?(0,r.jsxs)(r.Fragment,{children:["`SOLD OUT`",(0,r.jsx)("del",{children:e.name})]}):e.name})},"".concat(e.name,"_").concat(e.code,"_").concat(n)))]})})}let y=["RECENT","COFFEE","NON-COFFEE","TEA","ADE & JUICE","FLATCCINO","BOTTLE","SNACK","S / W"];var _=t(7848),N=t(3508),C=t(2280),k=t(8895),O=t(2797);function T(){let e=(0,a.useId)(),{data:n,isLoading:t}=(0,_.a)(u.a.menu.all,async()=>{let{data:e}=await x.Z.get("https://mcafe-api.onrender.com/menu");return e});return t?(0,r.jsx)(o.g,{}):(0,r.jsx)(r.Fragment,{children:n?(n=>{let t=e=>n.filter(n=>n.type===e-1);return y.map((n,o)=>(0,r.jsxs)(C.Z,{children:[(0,r.jsx)(k.Z,{expandIcon:(0,r.jsx)(N.Z,{}),children:(0,r.jsx)(j.Z,{children:n})}),(0,r.jsx)(O.Z,{children:(0,r.jsx)(S,{type:n,data:t(o)},"".concat(e+o))})]},e+o))})(n):(0,r.jsx)(o.g,{})})}var b=t(5179),D=t(4054),L=t(480),R=t(9368),I=t(2890),P=t(6872);function F(e){var n;let{idx:t,data:o,menuName:a}=e,{order:i}=(0,l.Sz)(d,e=>e[0]),s=(0,l.Sz)(d,e=>e[1]),c=(e,n)=>{let{name:t}=e.target;s({type:"SET_ORDER",order:{...i,optionValueList:h().defaults({[a]:n},{...i.optionValueList}),optionNameList:h().defaults({[a]:t},{...i.optionNameList})}})},u=e=>{let{value:n,checked:t,name:r}=e.target;s({type:"SET_ORDER",order:{...i,optionValueList:h().defaults({[a]:t?n:null},{...i.optionValueList}),optionNameList:h().defaults({[a]:t?r:null},{...i.optionNameList})}})};return(0,r.jsx)(v.Z,{children:(0,r.jsx)(D.Z,{children:(null==o?void 0:o.length)===1?(0,r.jsx)(L.Z,{value:o[0].code,control:(0,r.jsx)(R.Z,{onChange:u,defaultChecked:o[0].isOptionDefault}),label:o[0].name,name:o[0].name}):(0,r.jsx)(I.Z,{onChange:c,defaultValue:null===(n=null==o?void 0:o.find(e=>e.isOptionDefault))||void 0===n?void 0:n.code,children:null==o?void 0:o.map(e=>(0,r.jsx)(L.Z,{value:e.code,control:(0,r.jsx)(P.Z,{}),label:e.name,defaultChecked:e.isOptionDefault,name:e.name},"".concat(e.name,"_key")))})})})}var V=t(594),U=t(4510),A=t(7533),M=t(3946);function z(){var e,n;let{menu:t,order:i,isDrawerOpen:s}=(0,l.Sz)(d,e=>e[0]),c=(0,l.Sz)(d,e=>e[1]),{data:p,isLoading:m}=(e=t.code,n=void 0!==t.code,(0,_.a)(u.a.menu.option(e),async()=>{let{data:n}=await x.Z.get("https://mcafe-api.onrender.com/menu/".concat(e));return n},{enabled:n})),{mutate:h,isLoading:g}=f(),[Z,w]=(0,a.useState)(!1),S=async()=>{w(!0),!localStorage.getItem("phone")&&window.confirm("".concat(i.phone," 번호를 저장하시겠습까?"))&&localStorage.setItem("phone",i.phone),localStorage.setItem("coffee_order_".concat(new Date().toLocaleString()),JSON.stringify({order:i,menuCode:t.code,menuName:t.name})),h({order:i,menuCode:t.code},{onSuccess:e=>window.alert(e),onError:e=>{window.alert(e.message)},onSettled:()=>{w(!1),c({type:"INIT_MENU"})}})},y=e=>{c({type:"SET_ORDER",order:{...i,phone:e}})},T=()=>{c({type:"INIT_MENU"})};return(0,r.jsx)(A.ZP,{anchor:"bottom",open:s,onClose:T,ModalProps:{sx:{alignContent:"center",borderTopLeftRadius:3,borderTopRightRadius:3,height:"80vh"}},SlideProps:{},PaperProps:{sx:{width:"100%",alignContent:"center",m:"auto",p:2,borderTopLeftRadius:16,borderTopRightRadius:16,height:"80vh"}},children:m||g?(0,r.jsx)(o.g,{}):(0,r.jsxs)(v.Z,{children:[(0,r.jsx)(M.Z,{onClick:T,sx:{float:"right"},children:(0,r.jsx)(V.Z,{})}),(0,r.jsx)(j.Z,{variant:"h6",component:"h2",sx:{mt:1,mb:1,pl:1},children:t.name}),!!p&&p.optionGroupList.map((e,n)=>(0,r.jsxs)(C.Z,{sx:{mt:2},defaultExpanded:!0,children:[(0,r.jsx)(k.Z,{expandIcon:(0,r.jsx)(N.Z,{}),children:e.name}),(0,r.jsx)(O.Z,{children:(0,r.jsx)(F,{idx:n,data:e.optionValueList,menuName:e.name})})]})),(0,r.jsxs)(v.Z,{sx:{display:"flex",justifyContent:"space-around",gap:"8px"},children:[(0,r.jsx)(b.Z,{label:"핸드폰 번호",variant:"outlined",handleValueChange:y}),(0,r.jsx)(E.Z,{variant:"contained",onClick:S,disabled:Z,sx:{margin:"4px"},children:(0,r.jsx)(U.Z,{})})]})]})})}function J(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T,{}),(0,r.jsx)(z,{})]})}function W(){return(0,r.jsx)(d.Provider,{value:c(),children:(0,r.jsx)(J,{})})}}},function(e){e.O(0,[662,889,363,774,888,179],function(){return e(e.s=3023)}),_N_E=e.O()}]);